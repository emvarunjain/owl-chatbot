<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>OWL Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>body{font-family:system-ui,Arial,sans-serif;margin:2rem;} input,button{padding:.5rem;margin:.25rem;} pre{white-space:pre-wrap;background:#f6f8fa;padding:1rem;border-radius:6px;}</style>
</head>
<body>
  <h1>OWL Admin</h1>
  <section>
    <h3>Search</h3>
    <input id="tenant" placeholder="tenantId"/>
    <input id="q" placeholder="query"/>
    <button onclick="search()">Search</button>
    <pre id="out"></pre>
  </section>
  <section>
    <h3>Purge Source</h3>
    <input id="source" placeholder="filename or URL"/>
    <label><input type="checkbox" id="includeCache"/> include cache</label>
    <button onclick="purge()">Purge</button>
  </section>
  <script>
    async function search(){
      const tenant = document.getElementById('tenant').value;
      const q = document.getElementById('q').value||'overview';
      const res = await fetch(`/api/v1/admin/search?tenantId=${encodeURIComponent(tenant)}&q=${encodeURIComponent(q)}`);
      const data = await res.json();
      document.getElementById('out').textContent = JSON.stringify(data,null,2);
    }
    async function purge(){
      const tenant = document.getElementById('tenant').value;
      const source = document.getElementById('source').value;
      const includeCache = document.getElementById('includeCache').checked;
      const res = await fetch(`/api/v1/admin/purge?tenantId=${encodeURIComponent(tenant)}&source=${encodeURIComponent(source)}&includeCache=${includeCache}`,{method:'DELETE'});
      alert('purge: '+res.status);
    }
  </script>
</body>
</html>
